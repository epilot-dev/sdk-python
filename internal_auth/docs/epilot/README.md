# Epilot SDK

## Overview

Auth API to provide JWT tokens for internal API access that work with the epilot custom authorizer.

Converts AWS credentials into a JWT token with caller's ARN `callerIdentity` and list of `policies` granting access to API Gateway as claims.


### Available Operations

* [get_jwks](#get_jwks) - getJwks
* [get_open_id_configuration](#get_open_id_configuration) - getOpenIDConfiguration
* [get_token](#get_token) - getToken
* [get_token_v2](#get_token_v2) - getTokenV2

## get_jwks

Get jwks public key set to verify tokens generated by this API

### Example Usage

```python
import epilot


s = epilot.Epilot()


res = s.epilot.get_jwks()

if res.get_jwks_200_application_json_object is not None:
    # handle response
```

## get_open_id_configuration

OpenID Connect configuration for internal auth as identity provider

Note: This API is not a fully compliant OAuth2.0 / OIDC identity provider, but this endpoint is useful to
automate the process of verifying JWT tokens.


### Example Usage

```python
import epilot


s = epilot.Epilot()


res = s.epilot.get_open_id_configuration()

if res.get_open_id_configuration_200_application_json_object is not None:
    # handle response
```

## get_token

Generates token for internal API access

Example JWT payload:

```json
{
  "callerIdentity": "arn:aws:sts::912468240823:assumed-role/ep_prod_access_admin/awsmfa_20210225T193753",
  "policies": [
    {
      "Version": "2012-10-17",
      "Statement": [
        {
          "Effect": "Allow",
          "Action": "*",
          "Resource": "*"
        }
      ]
    }
  ],
  "iss": "https://internal-auth.sls.epilot.io/v1/internal-auth",
  "iat": 1614278397,
  "exp": 1614281997
}
```


### Example Usage

```python
import epilot


s = epilot.Epilot()


res = s.epilot.get_token()

if res.get_token_200_application_json_object is not None:
    # handle response
```

## get_token_v2

Generates token for internal API access with internal roles

Example JWT payload:

```json
{
  "callerIdentity": "arn:aws:sts::912468240823:assumed-role/ep_prod_access_admin/awsmfa_20210225T193753",
  "policies": [
    {
      "Version": "2012-10-17",
      "Statement": [
        {
          "Effect": "Allow",
          "Action": "*",
          "Resource": "*"
        }
      ]
    }
  ],
  "assume_roles": ["org_id:note_role", "org_id:file_role"],
  "org_id": "org_id",
  "iss": "https://internal-auth.sls.epilot.io/v1/internal-auth",
  "iat": 1614278397,
  "exp": 1614281997
}
```


### Example Usage

```python
import epilot
from epilot.models import operations

s = epilot.Epilot()


req = {
    "provident": "distinctio",
    "quibusdam": "unde",
    "nulla": "corrupti",
}

res = s.epilot.get_token_v2(req, operations.GetTokenV2Security(
    sigv4="YOUR_API_KEY_HERE",
))

if res.get_token_v2_200_application_json_object is not None:
    # handle response
```
